# AI Film Studio - Staging Environment Configuration
# This file is used for staging deployment
# All secrets stored in AWS Secrets Manager

#############################################
# Application Settings
#############################################
NODE_ENV=staging
API_URL=https://api-staging.ai-filmstudio.com
NEXT_PUBLIC_API_URL=https://api-staging.ai-filmstudio.com

#############################################
# Database Configuration
#############################################
# RDS PostgreSQL db.r6g.large Multi-AZ
DATABASE_URL={{resolve:secretsmanager:aifilm/staging/database-url}}
DB_HOST=staging-db.xxx.rds.amazonaws.com
DB_PORT=5432
DB_NAME=aifilm_staging
DB_USER={{resolve:secretsmanager:aifilm/staging/db-user}}
DB_PASSWORD={{resolve:secretsmanager:aifilm/staging/db-password}}
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_SSL_MODE=require

#############################################
# Redis Cache Configuration
#############################################
# ElastiCache cache.r6g.large Multi-AZ
REDIS_URL={{resolve:secretsmanager:aifilm/staging/redis-url}}
REDIS_HOST=staging-redis.xxx.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD={{resolve:secretsmanager:aifilm/staging/redis-password}}
REDIS_DB=0
REDIS_SSL=true
REDIS_CLUSTER_MODE=false

#############################################
# AWS Configuration
#############################################
AWS_REGION=us-east-1
USE_IAM_ROLE=true

# S3 Storage
S3_BUCKET=ai-film-studio-staging-us-east-1
S3_REGION=us-east-1
S3_VERSIONING=enabled
S3_LIFECYCLE_IA_DAYS=30

# SQS Queue
SQS_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/ACCOUNT_ID/aifilm-staging-jobs
SQS_DLQ_URL=https://sqs.us-east-1.amazonaws.com/ACCOUNT_ID/aifilm-staging-jobs-dlq
SQS_VISIBILITY_TIMEOUT=300

# CloudFront
CLOUDFRONT_DISTRIBUTION_ID=E1234567890ABC
CLOUDFRONT_DOMAIN=staging.ai-filmstudio.com

#############################################
# AI Models Configuration
#############################################
USE_MOCK_AI=false

# Model cache
MODEL_CACHE_DIR=/models
MODEL_S3_BUCKET=ai-film-studio-models-shared
MODEL_S3_PREFIX=production/

# AI API Keys
OPENAI_API_KEY={{resolve:secretsmanager:aifilm/staging/openai-key}}
ANTHROPIC_API_KEY={{resolve:secretsmanager:aifilm/staging/anthropic-key}}

# Model settings
AI_TIMEOUT_SECONDS=300
MAX_CONCURRENT_JOBS=10
GPU_INSTANCE_TYPE=g4dn.xlarge
GPU_MIN_INSTANCES=1
GPU_MAX_INSTANCES=3

#############################################
# Authentication & Security
#############################################
JWT_SECRET={{resolve:secretsmanager:aifilm/staging/jwt-secret}}
JWT_ALGORITHM=RS256
JWT_EXPIRATION_MINUTES=15
REFRESH_TOKEN_EXPIRATION_DAYS=7
JWT_PUBLIC_KEY={{resolve:secretsmanager:aifilm/staging/jwt-public-key}}
JWT_PRIVATE_KEY={{resolve:secretsmanager:aifilm/staging/jwt-private-key}}

# Password hashing
BCRYPT_ROUNDS=12

#############################################
# Email Configuration
#############################################
SMTP_HOST={{resolve:secretsmanager:aifilm/staging/smtp-host}}
SMTP_PORT=587
SMTP_USER={{resolve:secretsmanager:aifilm/staging/smtp-user}}
SMTP_PASSWORD={{resolve:secretsmanager:aifilm/staging/smtp-password}}
EMAIL_FROM=staging@ai-filmstudio.com
EMAIL_ENABLED=true

#############################################
# Payment Integration (Test Mode)
#############################################
STRIPE_SECRET_KEY={{resolve:secretsmanager:aifilm/staging/stripe-test-key}}
STRIPE_PUBLISHABLE_KEY={{resolve:secretsmanager:aifilm/staging/stripe-test-pub-key}}
STRIPE_WEBHOOK_SECRET={{resolve:secretsmanager:aifilm/staging/stripe-webhook-secret}}
STRIPE_MODE=test

#############################################
# Logging & Monitoring
#############################################
LOG_LEVEL=INFO
LOG_FORMAT=json
ENABLE_SQL_LOGGING=false

# CloudWatch
CLOUDWATCH_LOG_GROUP=/aws/ecs/aifilm-staging
CLOUDWATCH_REGION=us-east-1
CLOUDWATCH_RETENTION_DAYS=30

# Alarms
ENABLE_CLOUDWATCH_ALARMS=true
ALARM_EMAIL={{resolve:secretsmanager:aifilm/staging/alarm-email}}

#############################################
# Frontend Configuration
#############################################
NEXT_PUBLIC_SITE_URL=https://staging.ai-filmstudio.com
NEXT_PUBLIC_ENV=staging
NEXT_PUBLIC_ANALYTICS_ID=
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY={{resolve:secretsmanager:aifilm/staging/stripe-test-pub-key}}

#############################################
# Feature Flags
#############################################
ENABLE_SIGNUP=true
ENABLE_PAYMENT=true
ENABLE_YOUTUBE_UPLOAD=true
ENABLE_ANALYTICS=true
ENABLE_SOCIAL_LOGIN=true

#############################################
# Rate Limiting
#############################################
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_STORAGE=redis

#############################################
# File Upload Limits
#############################################
MAX_UPLOAD_SIZE_MB=1000
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,mp4,mov,avi,mp3,wav,m4a

#############################################
# Performance & Scaling
#############################################
# ECS Auto-scaling
ECS_MIN_TASKS=2
ECS_MAX_TASKS=8
ECS_TARGET_CPU_PERCENT=70
ECS_TARGET_MEMORY_PERCENT=80

# GPU Auto-scaling
GPU_SCALE_UP_THRESHOLD=10
GPU_SCALE_DOWN_THRESHOLD=2

#############################################
# Backup & Recovery
#############################################
DB_BACKUP_RETENTION_DAYS=14
ENABLE_POINT_IN_TIME_RECOVERY=true

#############################################
# Security
#############################################
ENABLE_WAF=true
ENABLE_HTTPS_ONLY=true
ENABLE_HSTS=true
CORS_ORIGINS=https://staging.ai-filmstudio.com
