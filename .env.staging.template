# ========================================
# AI FILM STUDIO - STAGING ENVIRONMENT
# ========================================
# Tags: #staging #pre-production #uat
# Last Updated: 2025-01-01
# ========================================

# ========================================
# 1. GENERAL SETTINGS
# ========================================
APP_NAME="AI Film Studio"
ENVIRONMENT=staging
NODE_ENV=production
DEBUG=false
LOG_LEVEL=INFO
TIMEZONE=UTC

# ========================================
# 2. API CONFIGURATION
# ========================================
API_HOST=0.0.0.0
API_PORT=8000
API_BASE_URL=https://api-staging.aifilmstudio.com
API_VERSION=v1
API_DOCS_ENABLED=false
API_DOCS_PATH=/docs

# CORS Settings
CORS_ORIGINS=https://staging.aifilmstudio.com,https://api-staging.aifilmstudio.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_HEADERS=*

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=500
RATE_LIMIT_WINDOW=60

# ========================================
# 3. FRONTEND CONFIGURATION
# ========================================
FRONTEND_URL=https://staging.aifilmstudio.com
NEXT_PUBLIC_API_URL=https://api-staging.aifilmstudio.com
NEXT_PUBLIC_APP_NAME="AI Film Studio (Staging)"
NEXT_PUBLIC_ENVIRONMENT=staging

# ========================================
# 4. DATABASE CONFIGURATION
# ========================================
# PostgreSQL
DATABASE_URL=postgresql://aifilm:{{RETRIEVE_FROM_SECRETS_MANAGER}}@staging-rds.cluster-xyz789.us-east-1.rds.amazonaws.com:5432/aifilmstudio_staging
DATABASE_HOST=staging-rds.cluster-xyz789.us-east-1.rds.amazonaws.com
DATABASE_PORT=5432
DATABASE_NAME=aifilmstudio_staging
DATABASE_USER=aifilm
DATABASE_PASSWORD={{RETRIEVE_FROM_SECRETS_MANAGER}}
DATABASE_POOL_SIZE=30
DATABASE_MAX_OVERFLOW=40
DATABASE_ECHO=false
DATABASE_SSL_MODE=require

# Read Replica (Optional)
DATABASE_REPLICA_URL=postgresql://aifilm:{{RETRIEVE_FROM_SECRETS_MANAGER}}@staging-rds-ro.cluster-xyz789.us-east-1.rds.amazonaws.com:5432/aifilmstudio_staging

# ========================================
# 5. REDIS / CACHE CONFIGURATION
# ========================================
REDIS_URL=rediss://staging-redis.xyz789.0001.use1.cache.amazonaws.com:6379/0
REDIS_HOST=staging-redis.xyz789.0001.use1.cache.amazonaws.com
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD={{RETRIEVE_FROM_SECRETS_MANAGER}}
REDIS_SSL=true
REDIS_SOCKET_KEEPALIVE=true
REDIS_DECODE_RESPONSES=true

# Cache Settings
CACHE_DEFAULT_TTL=900
CACHE_USER_SESSION_TTL=14400
CACHE_API_RESPONSE_TTL=300

# ========================================
# 6. AWS CONFIGURATION
# ========================================
AWS_REGION=us-east-1
# Use IAM roles for credentials - do not set these variables when using IAM roles
# If IAM roles are configured, AWS SDKs will automatically use them
# AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY should NOT be set
AWS_ACCOUNT_ID={{YOUR_AWS_ACCOUNT_ID}}

# S3 Buckets
S3_BUCKET_MEDIA=aifilmstudio-staging-media
S3_BUCKET_VIDEOS=aifilmstudio-staging-videos
S3_BUCKET_MODELS=aifilmstudio-staging-models
S3_BUCKET_LOGS=aifilmstudio-staging-logs
S3_BUCKET_BACKUPS=aifilmstudio-staging-backups

# S3 Settings
S3_PRESIGNED_URL_EXPIRY=3600
S3_UPLOAD_MAX_SIZE=104857600
S3_VIDEO_ACCEL_ENABLED=true

# CloudFront
CLOUDFRONT_DOMAIN=d456staging.cloudfront.net
CLOUDFRONT_DISTRIBUTION_ID=E456STAGING

# SQS
SQS_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/123456789012/aifilmstudio-staging-jobs
SQS_QUEUE_NAME=aifilmstudio-staging-jobs
SQS_DLQ_URL=https://sqs.us-east-1.amazonaws.com/123456789012/aifilmstudio-staging-jobs-dlq
SQS_VISIBILITY_TIMEOUT=300
SQS_WAIT_TIME=20
SQS_MAX_MESSAGES=10

# Secrets Manager
SECRETS_MANAGER_PREFIX=/aifilmstudio/staging/

# ========================================
# 7. SALESFORCE CONFIGURATION
# ========================================
SALESFORCE_INSTANCE_URL=https://your-staging-instance.sandbox.my.salesforce.com
SALESFORCE_API_VERSION=v59.0
SALESFORCE_CLIENT_ID={{RETRIEVE_FROM_SECRETS_MANAGER}}
SALESFORCE_CLIENT_SECRET={{RETRIEVE_FROM_SECRETS_MANAGER}}
SALESFORCE_USERNAME=staging-api@aifilmstudio.com.sandbox
SALESFORCE_PASSWORD={{RETRIEVE_FROM_SECRETS_MANAGER}}
SALESFORCE_SECURITY_TOKEN={{RETRIEVE_FROM_SECRETS_MANAGER}}

# Salesforce Objects
SALESFORCE_PROJECT_OBJECT=AI_Project__c
SALESFORCE_CREDIT_OBJECT=AI_Credit__c
SALESFORCE_YOUTUBE_OBJECT=YouTube_Integration__c
SALESFORCE_SUBSCRIPTION_OBJECT=User_Subscription__c

# Salesforce Settings
SALESFORCE_ENABLE_SYNC=true
SALESFORCE_SYNC_INTERVAL=180

# ========================================
# 8. YOUTUBE / GOOGLE API CONFIGURATION
# ========================================
GOOGLE_CLIENT_ID={{RETRIEVE_FROM_SECRETS_MANAGER}}
GOOGLE_CLIENT_SECRET={{RETRIEVE_FROM_SECRETS_MANAGER}}
GOOGLE_REDIRECT_URI=https://staging.aifilmstudio.com/api/auth/youtube/callback
GOOGLE_API_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}

# YouTube Settings
YOUTUBE_API_QUOTA_LIMIT=10000
YOUTUBE_UPLOAD_RETRY=5
YOUTUBE_UPLOAD_CHUNK_SIZE=10485760
YOUTUBE_DEFAULT_PRIVACY=unlisted
YOUTUBE_DEFAULT_CATEGORY=22

# OAuth Scopes
YOUTUBE_OAUTH_SCOPES=https://www.googleapis.com/auth/youtube.upload,https://www.googleapis.com/auth/youtube.readonly

# ========================================
# 9. AI / ML MODELS CONFIGURATION
# ========================================
# Model Storage
MODEL_CACHE_DIR=/mnt/efs/models
MODEL_S3_BUCKET=aifilmstudio-staging-models
MODEL_DOWNLOAD_TIMEOUT=600

# GPU Settings
CUDA_VISIBLE_DEVICES=0,1
TORCH_DEVICE=cuda
ENABLE_TF32=true
ENABLE_FLASH_ATTENTION=true
GPU_MEMORY_FRACTION=0.85

# Stable Diffusion
SD_MODEL_NAME=stabilityai/stable-diffusion-xl-base-1.0
SD_REFINER_NAME=stabilityai/stable-diffusion-xl-refiner-1.0
SD_VAE_NAME=madebyollin/sdxl-vae-fp16-fix
SD_INFERENCE_STEPS=30
SD_GUIDANCE_SCALE=7.5
SD_IMAGE_WIDTH=1024
SD_IMAGE_HEIGHT=1024
SD_BATCH_SIZE=2
SD_USE_FP16=true
SD_USE_XFORMERS=true

# Video Generation
VIDEO_MODEL_NAME=stabilityai/stable-video-diffusion-img2vid-xt
VIDEO_FPS=24
VIDEO_DURATION=4
VIDEO_MOTION_BUCKET_ID=127
VIDEO_NOISE_AUG_STRENGTH=0.02

# Text-to-Speech
TTS_PROVIDER=elevenlabs
ELEVENLABS_API_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}
ELEVENLABS_VOICE_ID=default
ELEVENLABS_MODEL_ID=eleven_multilingual_v2
TTS_SAMPLE_RATE=44100
TTS_OUTPUT_FORMAT=mp3

# Alternative TTS (Coqui)
COQUI_TTS_MODEL=tts_models/en/ljspeech/tacotron2-DDC
COQUI_TTS_VOCODER=vocoder_models/en/ljspeech/hifigan_v2

# FFmpeg
FFMPEG_THREADS=16
FFMPEG_PRESET=fast
FFMPEG_CRF=21
FFMPEG_VIDEO_CODEC=libx264
FFMPEG_AUDIO_CODEC=aac
FFMPEG_AUDIO_BITRATE=256k

# ========================================
# 10. AUTHENTICATION & SECURITY
# ========================================
# JWT Settings
JWT_SECRET_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# Password Hashing
PASSWORD_HASH_ALGORITHM=bcrypt
PASSWORD_HASH_ROUNDS=12
PASSWORD_MIN_LENGTH=10
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true

# Session
SESSION_SECRET={{RETRIEVE_FROM_SECRETS_MANAGER}}
SESSION_COOKIE_NAME=aifilm_session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_MAX_AGE=86400

# API Keys
API_KEY_HEADER=X-API-Key
API_KEY_PREFIX=aifilm_staging_

# ========================================
# 11. FEATURE FLAGS
# ========================================
FEATURE_USER_REGISTRATION=true
FEATURE_SOCIAL_LOGIN=true
FEATURE_YOUTUBE_UPLOAD=true
FEATURE_SALESFORCE_SYNC=true
FEATURE_PODCAST_MODE=true
FEATURE_SLOKAS_MODE=true
FEATURE_MULTI_LANGUAGE=true
FEATURE_ADMIN_DASHBOARD=true
FEATURE_ANALYTICS=true
FEATURE_CREDITS_SYSTEM=true
FEATURE_SUBSCRIPTIONS=true
FEATURE_WEBHOOKS=true

# ========================================
# 12. MONITORING & LOGGING
# ========================================
# CloudWatch
CLOUDWATCH_ENABLED=true
CLOUDWATCH_LOG_GROUP=/aws/aifilmstudio/staging
CLOUDWATCH_LOG_STREAM=backend
CLOUDWATCH_REGION=us-east-1

# Logging
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/aifilmstudio/app.log
LOG_MAX_SIZE=104857600
LOG_BACKUP_COUNT=20
LOG_CONSOLE_ENABLED=true
LOG_FILE_ENABLED=true

# Sentry
SENTRY_DSN={{RETRIEVE_FROM_SECRETS_MANAGER}}
SENTRY_ENVIRONMENT=staging
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_PROFILES_SAMPLE_RATE=0.5

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
PROMETHEUS_ENABLED=true

# X-Ray Tracing
XRAY_ENABLED=true
XRAY_SAMPLING_RATE=0.5

# ========================================
# 13. EMAIL / NOTIFICATION CONFIGURATION
# ========================================
# Email
EMAIL_PROVIDER=sendgrid
SENDGRID_API_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}
SENDGRID_FROM_EMAIL=noreply-staging@aifilmstudio.com
SMTP_FROM_NAME="AI Film Studio (Staging)"

# SMS / Twilio
TWILIO_ACCOUNT_SID={{RETRIEVE_FROM_SECRETS_MANAGER}}
TWILIO_AUTH_TOKEN={{RETRIEVE_FROM_SECRETS_MANAGER}}
TWILIO_PHONE_NUMBER=+1234567890
SMS_ENABLED=true

# Push Notifications
PUSH_NOTIFICATIONS_ENABLED=true
FIREBASE_SERVER_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}

# ========================================
# 14. THIRD-PARTY SERVICES
# ========================================
# Analytics
GOOGLE_ANALYTICS_ID=G-STAGINGID456
MIXPANEL_TOKEN={{RETRIEVE_FROM_SECRETS_MANAGER}}
SEGMENT_WRITE_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}

# Payment Processing
STRIPE_PUBLIC_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}
STRIPE_SECRET_KEY={{RETRIEVE_FROM_SECRETS_MANAGER}}
STRIPE_WEBHOOK_SECRET={{RETRIEVE_FROM_SECRETS_MANAGER}}
STRIPE_PRICE_ID_BASIC=price_staging_basic_id
STRIPE_PRICE_ID_PRO=price_staging_pro_id

# ========================================
# 15. JOB PROCESSING
# ========================================
# Worker Configuration
WORKER_CONCURRENCY=8
WORKER_POLL_INTERVAL=3
WORKER_MAX_RETRIES=5
WORKER_RETRY_BACKOFF=2

# Job Timeouts
JOB_TIMEOUT_IMAGE_GEN=300
JOB_TIMEOUT_VIDEO_GEN=600
JOB_TIMEOUT_AUDIO_GEN=180
JOB_TIMEOUT_VIDEO_COMPOSE=300

# ========================================
# 16. CREDIT SYSTEM
# ========================================
CREDITS_ENABLED=true
CREDITS_DEFAULT_BALANCE=50
CREDITS_IMAGE_GENERATION=5
CREDITS_VIDEO_GENERATION=20
CREDITS_AUDIO_GENERATION=3
CREDITS_YOUTUBE_UPLOAD=2
CREDITS_REFUND_ON_FAILURE=true

# ========================================
# 17. DEVELOPMENT TOOLS
# ========================================
# Hot Reload
HOT_RELOAD_ENABLED=false
RELOAD_DIRS=

# Mock Services
MOCK_SALESFORCE=false
MOCK_YOUTUBE=false
MOCK_AI_MODELS=false
MOCK_PAYMENT=false

# Seeding
SEED_DATABASE=false
SEED_USERS=0
SEED_PROJECTS=0

# ========================================
# 18. PERFORMANCE TUNING
# ========================================
# Connection Pooling
DB_POOL_SIZE=40
DB_POOL_RECYCLE=3600
DB_POOL_TIMEOUT=30

# Worker Threads
WORKER_THREADS=16
ASYNC_IO_THREADS=32

# Request Timeout
REQUEST_TIMEOUT=30
UPLOAD_TIMEOUT=300

# ========================================
# 19. BACKUP & RECOVERY
# ========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=aifilmstudio-staging-backups

# ========================================
# 20. SECURITY HEADERS
# ========================================
SECURITY_HEADERS_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff

# ========================================
# 21. AUTO-SCALING
# ========================================
AUTO_SCALING_ENABLED=true
AUTO_SCALING_MIN_INSTANCES=2
AUTO_SCALING_MAX_INSTANCES=8
AUTO_SCALING_TARGET_CPU=70
AUTO_SCALING_TARGET_MEMORY=80

# ========================================
# END OF STAGING ENVIRONMENT CONFIG
# ========================================
